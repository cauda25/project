<!DOCTYPE html>
<html lang="en" layout:decorate="~{/layouts/layout}">
  <div layout:fragment="content">
    <section class="register-form spad">
      <div class="container">
        <div style="
            background: #1e1e2d; /* 어두운 배경 */
            border: 1px solid #444;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            max-width: 500px;
            margin: 0 auto;
            color: #fff; /* 글씨 색상 */
          ">
          <h3 style="
              text-align: center;
              font-weight: bold;
              margin-bottom: 20px;
              color: #ff4c4c; /* 강조색 */
            ">
            회원가입
          </h3>
          <form th:action="@{/member/register}" method="post" th:object="${memberDto}" onsubmit="return validateForm()">
            <!-- 아이디 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="memberId" style="font-weight: bold">아이디</label>
              <input type="text" id="memberId" th:field="*{memberId}" placeholder="아이디 입력" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required"/>
              <span id="idError" style="color: red; font-size: 12px"></span>
            </div>

            <!-- 비밀번호 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="password" style="font-weight: bold">비밀번호</label>
              <input type="password" id="password" th:field="*{password}" placeholder="비밀번호 입력 (숫자 5자리 이상 및 특수기호 포함)" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required"/>
            </div>

            <!-- 비밀번호 재확인 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="passwordCheck" style="font-weight: bold">비밀번호 재확인</label>
              <input type="password" id="passwordCheck" placeholder="비밀번호 재입력" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required"/>
              <span id="passwordError" style="color: red; font-size: 12px"></span>
            </div>

            <!-- 이메일 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="email" style="font-weight: bold">이메일</label>
              <input type="email" id="email" th:field="*{email}" placeholder="이메일 입력" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required"/>
              <span id="emailError" style="color: red; font-size: 12px"></span>
            </div>

            <!-- 이름 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="name" style="font-weight: bold">이름</label>
              <input type="text" id="name" th:field="*{name}" placeholder="이름 입력" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required"/>
            </div>

            <!-- 생년월일 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="birth" style="font-weight: bold">생년월일</label>
              <input type="date" id="birth" th:field="*{birth}" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required"/>
            </div>

            <!-- 성별 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="gender" style="font-weight: bold">성별</label>
              <select id="gender" th:field="*{gender}" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" required="required">
                <option value="">성별 선택</option>
                <option value="남성">남성</option>
                <option value="여성">여성</option>
              </select>
            </div>

            <!-- 휴대전화 -->
            <div class="form-group" style="margin-bottom: 15px">
              <label for="phone" style="font-weight: bold">휴대전화</label>
              <input type="text" id="phone" th:field="*{phone}" placeholder="010-1234-5678 형식으로 입력" style="background: #333; color: #fff; border: 1px solid #555" class="form-control" oninput="formatPhoneNumber(this)" required="required"/>
              <span id="phoneError" style="color: red; font-size: 12px"></span>
            </div>
            <!-- 주소 -->
            <div class="form-group" style="margin-bottom: 15px; display: flex; gap: 10px">
              <div style="flex: 1">
                <label for="city" style="font-weight: bold">주소를 적어주세요 (도·시)</label>
                <select id="city" name="city" style="
                    background: #333;
                    color: #fff;
                    border: 1px solid #555;
                    width: 100%;
                  " class="form-control" required="required">
                  <option value="">도·시를 선택하세요</option>
                  <option value="서울특별시">서울특별시</option>
                  <option value="부산광역시">부산광역시</option>
                  <option value="대구광역시">대구광역시</option>
                  <option value="인천광역시">인천광역시</option>
                  <option value="광주광역시">광주광역시</option>
                  <option value="대전광역시">대전광역시</option>
                  <option value="울산광역시">울산광역시</option>
                  <option value="세종특별자치시">세종특별자치시</option>
                  <option value="경기도">경기도</option>
                  <option value="강원도">강원도</option>
                  <option value="충청북도">충청북도</option>
                  <option value="충청남도">충청남도</option>
                  <option value="전라북도">전라북도</option>
                  <option value="전라남도">전라남도</option>
                  <option value="경상북도">경상북도</option>
                  <option value="경상남도">경상남도</option>
                  <option value="제주특별자치도">제주특별자치도</option>
                </select>
              </div>

              <div style="flex: 1">
                <label for="district" style="font-weight: bold">주소를 적어주세요 (구·군·시)</label>
                <input type="text" id="district" name="district" placeholder="구·군·시 입력" style="
                    background: #333;
                    color: #fff;
                    border: 1px solid #555;
                    width: 100%;
                  " class="form-control" required="required"/>
              </div>
            </div>

            <!-- 가입하기 버튼 -->
            <div style="text-align: center; margin-top: 20px">
              <button type="submit" style="
                  background-color: #ff4c4c;
                  color: #1e1e2d;
                  border: none;
                  padding: 10px 20px;
                  border-radius: 5px;
                  cursor: pointer;
                  font-weight: bold;
                ">
                가입하기
              </button>
            </div>
          </form>
        </div>
      </div>
    </section>
  </div>

  <th:block layout:fragment="js">
    <script>
      function formatPhoneNumber(input) {
            let value = input.value.replace(/[^0-9]/g, ""); // 숫자만 허용
            if (value.length > 3 && value.length <= 7) {
                input.value = `${value.slice(0, 3)}-${value.slice(3)}`;
            } else if (value.length > 7) {
                input.value = `${value.slice(0, 3)}-${value.slice(
            3,
            7
          )}-${value.slice(7, 11)}`;
            } else {
                input.value = value;
            }
        }

        function validateForm() {
            let phone = document.getElementById("phone").value;
            let password = document.getElementById("password").value;
            let passwordCheck = document.getElementById("passwordCheck").value;
            let phoneError = document.getElementById("phoneError");
            let passwordError = document.getElementById("passwordError");

            // 전화번호 형식 확인
            const phoneRegex = /^010-\d{4}-\d{4}$/;
            if (!phoneRegex.test(phone)) {
                phoneError.textContent =
                    "전화번호는 010으로 시작해서 형식에 맞게 입력해주세요.";
                return false;
            } else {
                phoneError.textContent = ""; // 오류 없으면 메시지 초기화
            }

            // 비밀번호 형식 확인: 숫자 5자리 이상 및 특수기호 포함
            const passwordRegex = /^(?=.*\d{5,})(?=.*[!@#$%^&*(),.?":{}|<>]).+$/;
            if (!passwordRegex.test(password)) {
                passwordError.textContent =
                    "비밀번호는 숫자 5자리 이상 및 특수기호를 포함해야 합니다.";
                return false;
            } else {
                passwordError.textContent = ""; // 오류 없으면 메시지 초기화
            }

            // 비밀번호와 비밀번호 재확인 일치 여부 확인
            if (password !== passwordCheck) {
                passwordError.textContent =
                    "비밀번호와 비밀번호 확인이 일치하지 않습니다.";
                return false;
            }

            return true; // 모든 유효성 검사가 통과하면 true 반환
        }
    </script>
</th:block>

</html>
